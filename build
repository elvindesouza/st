#!/bin/env bash

if grep -q 'ID_LIKE=debian' /etc/os-release; then
    sudo apt install -y build-essential libx11-dev libxft-dev libharfbuzz-dev libxext-dev libimlib2-dev 
    sudo apt-mark auto build-essential libx11-dev libxft-dev libharfbuzz-dev libxext-dev libimlib2-dev 
elif command -v pacman &> /dev/null; then
    sudo pacman -S --needed --noconfirm base-devel libx11 libxft harfbuzz libxext imlib2
fi

echo "Go to ~/.local/share/fonts and run the script to download fonts"

rm -f config.h
rm -f patches.h


git clone https://github.com/NikitaIvanovV/ctpv
cd ctpv || exit && \
if grep -q 'ID_LIKE=debian' /etc/os-release; then # Debian-based and Ubuntu-based
    sudo apt install -y libmagic-dev libcrypto++-dev
    sudo apt-mark auto libmagic-dev libcrypto++-dev
    make clean && \
    sudo make install
    # to uninstall-
    # sudo make uninstall
fi && \
cd .. && sudo rm -rf ctpv

wget -c https://github.com/gokcehan/lf/releases/download/r31/lf-linux-amd64.tar.gz -O - | tar xz -C "$HOME"/bin && \
chmod +x "$HOME"/bin/lf

sudo make clean install && \
if command -v apt &> /dev/null; then
    echo 'Remember to remove orphan build dependencies'
elif command -v pacman &> /dev/null; then
    # sudo pacman -Rns
    echo '\n\nRemember to remove orphan build dependencies later'
fi && \
st
